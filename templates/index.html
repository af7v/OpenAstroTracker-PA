<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>OAT Polar Alignment</title>
    <link rel="stylesheet" href="/static/style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.5.4/socket.io.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <h1>OAT Polar Alignment</h1>
            <div class="connection-status">
                <span id="mount-status" class="status-dot disconnected"></span>
                <span id="mount-label">Mount: Disconnected</span>
            </div>
        </header>

        <!-- Main Content -->
        <main>
            <!-- Position Display -->
            <section class="panel position-panel">
                <h2>Mount Position</h2>
                <div class="position-display">
                    <div class="coord">
                        <label>RA</label>
                        <span id="mount-ra">--:--:--</span>
                    </div>
                    <div class="coord">
                        <label>DEC</label>
                        <span id="mount-dec">--Â°--'--"</span>
                    </div>
                </div>
                <div class="tracking-status">
                    <span id="tracking-indicator" class="indicator off"></span>
                    <span id="tracking-label">Tracking: Off</span>
                </div>
            </section>

            <!-- PA Error Display -->
            <section class="panel pa-panel">
                <h2>Polar Alignment Error</h2>
                <div class="pa-display">
                    <div class="pa-error">
                        <div class="error-value">
                            <label>AZ</label>
                            <span id="pa-az">--</span>
                            <small>arcmin</small>
                        </div>
                        <div class="error-value">
                            <label>ALT</label>
                            <span id="pa-alt">--</span>
                            <small>arcmin</small>
                        </div>
                        <div class="error-value total">
                            <label>Total</label>
                            <span id="pa-total">--</span>
                            <small>arcsec</small>
                        </div>
                    </div>
                    <div class="pa-progress">
                        <div class="progress-bar">
                            <div id="pa-progress-fill" class="progress-fill"></div>
                        </div>
                        <span id="pa-status">Not measured</span>
                    </div>
                </div>
            </section>

            <!-- Auto-Align Controls -->
            <section class="panel align-panel">
                <h2>Auto Alignment</h2>
                <div class="align-controls">
                    <button id="btn-auto-align" class="btn btn-primary btn-large">
                        Start Auto-Align
                    </button>
                    <div class="accuracy-setting">
                        <label>Target Accuracy:</label>
                        <input type="number" id="target-accuracy" value="60" min="10" max="300" step="10">
                        <span>arcsec</span>
                    </div>
                </div>
                <div id="align-status" class="status-log"></div>
            </section>

            <!-- RA/DEC Jog Controls -->
            <section class="panel jog-panel">
                <h2>RA/DEC Jog</h2>
                <div class="jog-controls">
                    <div class="dpad">
                        <button class="dpad-btn north" data-dir="n">N</button>
                        <button class="dpad-btn west" data-dir="w">W</button>
                        <button class="dpad-btn stop" data-dir="a">Stop</button>
                        <button class="dpad-btn east" data-dir="e">E</button>
                        <button class="dpad-btn south" data-dir="s">S</button>
                    </div>
                    <div class="speed-selector">
                        <label>Speed:</label>
                        <select id="slew-rate">
                            <option value="G">Guide</option>
                            <option value="C">Center</option>
                            <option value="M" selected>Find</option>
                            <option value="S">Slew</option>
                        </select>
                    </div>
                </div>
            </section>

            <!-- AZ/ALT Jog Controls -->
            <section class="panel azalt-panel">
                <h2>AZ/ALT Jog (PA Adjustment)</h2>
                <div class="azalt-controls">
                    <div class="azalt-group">
                        <label>Azimuth</label>
                        <div class="azalt-buttons">
                            <button class="btn" id="btn-az-minus">AZ -</button>
                            <input type="number" id="az-step" value="5" min="0.1" max="30" step="0.5">
                            <button class="btn" id="btn-az-plus">AZ +</button>
                        </div>
                    </div>
                    <div class="azalt-group">
                        <label>Altitude</label>
                        <div class="azalt-buttons">
                            <button class="btn" id="btn-alt-minus">ALT -</button>
                            <input type="number" id="alt-step" value="5" min="0.1" max="30" step="0.5">
                            <button class="btn" id="btn-alt-plus">ALT +</button>
                        </div>
                    </div>
                    <small>Values in arcminutes</small>
                </div>
            </section>

            <!-- Capture Controls -->
            <section class="panel capture-panel">
                <h2>Capture & Solve</h2>
                <div class="capture-controls">
                    <div class="capture-settings">
                        <div class="setting">
                            <label>Exposure:</label>
                            <input type="number" id="exposure" value="2" min="0.1" max="30" step="0.5">
                            <span>sec</span>
                        </div>
                        <div class="setting">
                            <label>Gain:</label>
                            <input type="number" id="gain" value="100" min="0" max="500" step="10">
                        </div>
                    </div>
                    <div class="capture-buttons">
                        <button id="btn-capture" class="btn">Capture</button>
                        <button id="btn-solve" class="btn">Solve</button>
                        <button id="btn-capture-solve" class="btn btn-primary">Capture & Solve</button>
                    </div>
                </div>
                <div id="solve-result" class="solve-result"></div>
            </section>

            <!-- Connection Panel -->
            <section class="panel connect-panel">
                <h2>Connection</h2>
                <div class="connect-controls">
                    <div class="setting">
                        <label>Serial Port:</label>
                        <input type="text" id="serial-port" value="/dev/ttyACM0">
                    </div>
                    <div class="connect-buttons">
                        <button id="btn-connect" class="btn btn-primary">Connect</button>
                        <button id="btn-disconnect" class="btn">Disconnect</button>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer>
            <small>OpenAstroTracker Web PA v1.0</small>
        </footer>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
